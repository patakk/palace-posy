class Color{constructor(o,l,r,c){c?this.a=c:c=1,this.r=o,this.g=l,this.b=r}}function lerpcol(o,l,r){return new Color(o.r+r*(l.r-o.r),o.g+r*(l.g-o.g),o.b+r*(l.b-o.b),1)}function addcol(o,l){return new Color(o.r+l.r,o.g+l.g,o.b+l.b,1)}function scalecol(o,l){return new Color(o.r*l,o.g*l,o.b*l,o.a)}function saturatecol([o,l,r],c){var e=new Color(o,l,r,1);if(Math.abs(c)<.004)return[o,l,r];if(0==e.r&&0==e.g&&0==e.b)return[o,l,r];var a=new Color(e.r,e.g,e.b,e.a);if(c>0&&(a=lerpcol(a,scalecol(a,1/max(max(e.r,e.g),e.b)),c)),c<0){var n=(e.r+e.g+e.b)/3;a=lerpcol(a,new Color(n,n,n,1),-c)}return[a.r,a.g,a.b]}function map2(o){return ryb2rgb(step2(o),step2(o-120/360),step2(o-240/360))}function step2(o){var l=0,r=0;for(deg=360*o;deg<0;)deg+=360;for(;deg>360;)deg-=360;return deg<=60?l=1:deg>60&&deg<=120?l=1-2*(r=(deg-60)/60)/Math.sqrt(1+3*r*r):deg>120&&deg<=240?l=0:deg>240&&deg<=300?l=2*(r=(deg-240)/60)/Math.sqrt(1+3*r*r):deg>300&&deg<=360&&(l=1),l}function ryb2rgb(o,l,r){var c=o,e=l,a=r,n=new Color(0,0,0),t=new Color(.9,.1,0),s=new Color(.9,.9,0),d=new Color(0,.36,1),g=new Color(0,.8,.3),i=new Color(1,.6,0),b=new Color(.6,0,1),u=new Color(1,1,1),C=addcol(scalecol(n,1-c),scalecol(t,c)),w=addcol(scalecol(d,1-c),scalecol(b,c)),f=addcol(scalecol(s,1-c),scalecol(i,c)),h=addcol(scalecol(g,1-c),scalecol(u,c)),m=addcol(scalecol(C,1-e),scalecol(f,e)),v=addcol(scalecol(w,1-e),scalecol(h,e)),x=addcol(scalecol(m,1-a),scalecol(v,a));return[x.r,x.g,x.b]}function rgb2ryb(o,l,r){var c=o,e=l,a=r,n=new Color(0,0,0),t=new Color(.891,0,0),s=new Color(0,.714,.374),d=new Color(.07,.08,.893),g=new Color(0,.116,.313),i=new Color(0,.915,0),b=new Color(.554,0,.1),u=new Color(1,1,1),C=addcol(scalecol(n,1-c),scalecol(t,c)),w=addcol(scalecol(d,1-c),scalecol(b,c)),f=addcol(scalecol(s,1-c),scalecol(i,c)),h=addcol(scalecol(g,1-c),scalecol(u,c)),m=addcol(scalecol(C,1-e),scalecol(f,e)),v=addcol(scalecol(w,1-e),scalecol(h,e)),x=addcol(scalecol(m,1-a),scalecol(v,a));return saturate([x.r,x.g,x.b],.5)}function mixcol(o,l,r){return new Color(Math.sqrt((1-r)*(o.r*o.r)+r*(l.r*l.r)),Math.sqrt((1-r)*(o.g*o.g)+r*(l.g*l.g)),Math.sqrt((1-r)*(o.b*o.b)+r*(l.b*l.b)),(1-r)*o.a+r*l.a)}function mixcollin(o,l,r){return new Color((1-r)*o.r+r*l.r,(1-r)*o.r+r*l.r,(1-r)*o.r+r*l.r,(1-r)*o.a+r*l.a)}function invcol(o){return new Color(1-o.r,1-o.g,1-o.g,o.a)}function brightencol([o,l,r],c){var e,a=new Color(o,l,r,1);return 0==c?[o,l,r]:c>0?[(e=mixcol(a,new Color(1,1,1,1),c)).r,e.g,e.b]:c<0?[(e=mixcol(a,new Color(0,0,0,1),-c)).r,e.g,e.b]:void 0}function distcolor(o,l){return Math.sqrt((o.r-l.r)*(o.r-l.r)+(o.g-l.g)*(o.g-l.g)+(o.b-l.b)*(o.b-l.b))/Math.sqrt(3)}function mixsubcol(o,l,r){var c=invcol(o),e=invcol(l),a=new Color(max(0,1-c.r-e.r),max(0,1-c.g-e.g),max(0,1-c.b-e.b),1),n=distcolor(o,l);return n*=4*r*(1-r),mixcollin(mixcollin(o,l,r),a,n)}