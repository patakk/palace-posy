function shuffle(r){let n=r.length;for(var e;0!=n;)e=Math.floor(fxrand()*n),n--,[r[n],r[e]]=[r[e],r[n]];return r}function hex2rgb(r){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return n?[parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255]:null}function hsl2rgb(r,n,e){var t,a,i;if(0==n)t=a=i=e;else{var o=function(r,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+6*(n-r)*e:e<.5?n:e<2/3?r+(n-r)*(2/3-e)*6:r},s=e<.5?e*(1+n):e+n-e*n,u=2*e-s;t=o(u,s,r+1/3),a=o(u,s,r),i=o(u,s,r-1/3)}var c=.299*t+.587*a+.114*i;return[t=min(1,max(0,t*e/c)),a=min(1,max(0,a*e/c)),i=min(1,max(0,i*e/c))]}function hsv2rgb(r,n,e){var t,a,i,o,s,u,c,f;switch(1===arguments.length&&(n=r.s,e=r.v,r=r.h),u=e*(1-n),c=e*(1-(s=6*r-(o=Math.floor(6*r)))*n),f=e*(1-(1-s)*n),o%6){case 0:t=e,a=f,i=u;break;case 1:t=c,a=e,i=u;break;case 2:t=u,a=e,i=f;break;case 3:t=u,a=c,i=e;break;case 4:t=f,a=u,i=e;break;case 5:t=e,a=u,i=c}return[t,a,i]}function rgb2hsl(r,n,e){var t,a,i=Math.max(r,n,e),o=Math.min(r,n,e),s=(i+o)/2;if(i==o)t=a=0;else{var u=i-o;switch(a=s>.5?u/(2-i-o):u/(i+o),i){case r:t=(n-e)/u+(n<e?6:0);break;case n:t=(e-r)/u+2;break;case e:t=(r-n)/u+4}t/=6}return[t,a,s]}function rgb2hsv(r,n,e){let t,a,i,o,s,u,c,f,h,b,g;return t=r,a=n,i=e,h=Math.max(t,a,i),b=h-Math.min(t,a,i),g=r=>(h-r)/6/b+.5,0==b?c=f=0:(f=b/h,o=g(t),s=g(a),u=g(i),t===h?c=u-s:a===h?c=1/3+o-u:i===h&&(c=2/3+s-o),c<0?c+=1:c>1&&(c-=1)),[c,f,h]}function rgbToXyz(r){const n=r[0],e=r[1],t=r[2];return[.4124*n+.3576*e+.1805*t,.2126*n+.7152*e+.0722*t,.0193*n+.1192*e+.9505*t].map((r=>100*r))}function sRGBtoLinearRGB(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function hexToRgb(r){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);if(n)return n.shift(),n.map((r=>parseInt(r,16)))}const D65=[95.047,100,108.883];function xyzToLab([r,n,e]){return[r,n,e]=[r,n,e].map(((r,n)=>(r/=D65[n])>.008856?Math.pow(r,1/3):7.787*r+16/116)),[116*n-16,500*(r-n),200*(n-e)]}function labToLch([r,n,e]){return[r,Math.sqrt(n*n+e*e),abToHue(n,e)]}function abToHue(r,n){if(r>=0&&0===n)return 0;if(r<0&&0===n)return 180;if(0===r&&n>0)return 90;if(0===r&&n<0)return 270;let e;return r>0&&n>0?e=0:r<0?e=180:r>0&&n<0&&(e=360),radiansToDegrees(Math.atan(n/r))+e}function radiansToDegrees(r){return r*(180/Math.PI)}function degreesToRadians(r){return r*Math.PI/180}function getLightnessUsingFairchildPirrottaCorrection([r,n,e]){return r+(2.5-.025*r)*(.116*Math.abs(Math.sin(degreesToRadians((e-90)/2)))+.085)*n}function getPerceivedLightness(r){return getLightnessUsingFairchildPirrottaCorrection(labToLch(xyzToLab(rgbToXyz(r))))}